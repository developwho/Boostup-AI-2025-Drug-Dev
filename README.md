# CYP3A4 íš¨ì†Œ ì €í•´ìœ¨ ì˜ˆì¸¡ ëª¨ë¸

**Boost up AI 2025 ì‹ ì•½ ê°œë°œ ê²½ì§„ëŒ€íšŒ** ì œì¶œìš© ëª¨ë¸

## ðŸ† ëª¨ë¸ ê°œìš”

**ìµœì¢… ëª¨ë¸**: LightGBM + GNN Stacking Ensemble
- **Private Score ë³µì› ê°€ëŠ¥**
- **ì™„ì „í•œ ì‹œë“œ ê³ ì •ìœ¼ë¡œ ìž¬í˜„ì„± ë³´ìž¥**
- **5-Fold Cross Validation ì ìš©**

### ëª¨ë¸ êµ¬ì„±
1. **LightGBM**: ë¶„ìž íŠ¹ì§• ê¸°ë°˜ ì˜ˆì¸¡ (ìµœì í™”ëœ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì ìš©)
2. **Graph Neural Network**: ë¶„ìž ê·¸ëž˜í”„ êµ¬ì¡° ê¸°ë°˜ ì˜ˆì¸¡
3. **Stacking Meta Model**: Ridge íšŒê·€ë¡œ ë‘ ëª¨ë¸ ê²°í•©

## ðŸ“ íŒŒì¼ êµ¬ì¡°

```
â”œâ”€â”€ train.py                  # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ inference.py              # ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ README.md                 # ì‚¬ìš© ê°€ì´ë“œ
â”œâ”€â”€ requirements.txt          # ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„±
â”œâ”€â”€ train.csv                 # í•™ìŠµ ë°ì´í„°
â”œâ”€â”€ test.csv                  # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â””â”€â”€ models/                   # í•™ìŠµëœ ëª¨ë¸ ì €ìž¥ ë””ë ‰í† ë¦¬
    â”œâ”€â”€ lgbm_fold_0.pkl ~ lgbm_fold_4.pkl
    â”œâ”€â”€ gnn_fold_0.pth ~ gnn_fold_4.pth
    â”œâ”€â”€ stacking_meta_model.pkl
    â”œâ”€â”€ lgbm_test_preds.npy
    â””â”€â”€ gnn_test_preds.npy
```

## ðŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •

```bash
# í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. í•™ìŠµ ì‹¤í–‰

```bash
# ì „ì²´ ëª¨ë¸ í•™ìŠµ (ì•½ 2-3ì‹œê°„ ì†Œìš”)
python train.py
```

**í•™ìŠµ ê³¼ì •:**
- ë°ì´í„° ì „ì²˜ë¦¬ ë° íŠ¹ì§• ì¶”ì¶œ
- LightGBM 5-Fold CV í•™ìŠµ
- GNN 5-Fold CV í•™ìŠµ  
- ìŠ¤íƒœí‚¹ ë©”íƒ€ ëª¨ë¸ í•™ìŠµ
- ëª¨ë“  ëª¨ë¸ ê°€ì¤‘ì¹˜ ìžë™ ì €ìž¥

### 3. ì¶”ë¡  ì‹¤í–‰

```bash
# í…ŒìŠ¤íŠ¸ ë°ì´í„° ì˜ˆì¸¡
python inference.py
```

**ìƒì„±ë˜ëŠ” íŒŒì¼:**
- `stacking_submission.csv` (ìµœì¢… ì œì¶œ íŒŒì¼)
- `lgbm_submission.csv` (LightGBM ë‹¨ë… ì˜ˆì¸¡)
- `gnn_submission.csv` (GNN ë‹¨ë… ì˜ˆì¸¡)

## âš™ï¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°

### LightGBM ìµœì  íŒŒë¼ë¯¸í„°
```python
{
    'learning_rate': 0.088,
    'num_leaves': 273,
    'max_depth': 3,
    'subsample': 0.999,
    'colsample_bytree': 0.998,
    'reg_alpha': 1.56e-08,
    'reg_lambda': 4.33e-05
}
```

### GNN ìµœì  íŒŒë¼ë¯¸í„°
```python
{
    'hidden_dim': 64,
    'num_layers': 4,
    'dropout': 0.176,
    'lr': 0.00127,
    'weight_decay': 4.08e-05
}
```

## ðŸ”’ ìž¬í˜„ì„± ë³´ìž¥

### ì‹œë“œ ê³ ì •
- Python random: 42
- NumPy: 42
- PyTorch: 42
- PYTHONHASHSEED: 42
- CUDA deterministic mode í™œì„±í™”

### ë°ì´í„° ìˆœì„œ ê³ ì •
- DataFrame ID ê¸°ì¤€ ì •ë ¬
- Cross-validation ë¶„í•  ê³ ì •
- DataLoader shuffle ì œì–´

## ðŸ“Š ì„±ëŠ¥ ì§€í‘œ

- **í‰ê°€ ë©”íŠ¸ë¦­**: 0.5 Ã— (1 - min(NRMSE, 1)) + 0.5 Ã— PCC
- **NRMSE**: Normalized Root Mean Square Error
- **PCC**: Pearson Correlation Coefficient

## ðŸŽ¯ ì œì¶œ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… í•„ìˆ˜ í™•ì¸ì‚¬í•­
- [ ] `train.csv`, `test.csv` íŒŒì¼ ì¡´ìž¬
- [ ] `models/` ë””ë ‰í† ë¦¬ì— ëª¨ë“  ëª¨ë¸ íŒŒì¼ ìƒì„± í™•ì¸
- [ ] `stacking_submission.csv` íŒŒì¼ ìƒì„± í™•ì¸
- [ ] ì˜ˆì¸¡ê°’ì´ 0-100 ë²”ìœ„ ë‚´ì— ìžˆëŠ”ì§€ í™•ì¸

### âœ… Private Score ë³µì› ê²€ì¦
```bash
# ë™ì¼í•œ í™˜ê²½ì—ì„œ ìž¬ì‹¤í–‰ ì‹œ ë™ì¼í•œ ê²°ê³¼ í™•ì¸
python train.py
python inference.py
# â†’ ì´ì „ ê²°ê³¼ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
```

## ðŸ› ï¸ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### ìµœì†Œ ì‚¬ì–‘
- **RAM**: 8GB ì´ìƒ
- **GPU**: CUDA ì§€ì› (ê¶Œìž¥, CPUë„ ê°€ëŠ¥)
- **Python**: 3.8 ì´ìƒ
- **ì‹¤í–‰ ì‹œê°„**: í•™ìŠµ 2-3ì‹œê°„, ì¶”ë¡  5-10ë¶„

### ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „
```
torch >= 1.12.0
torch-geometric >= 2.1.0
lightgbm >= 3.3.0
rdkit-pypi >= 2022.3.5
scikit-learn >= 1.1.0
pandas >= 1.4.0
numpy < 2.0.0
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### GPU ì‚¬ìš© ì‹œ
- CUDA ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ë°°ì¹˜ í¬ê¸° ì¡°ì •
- PyTorch CUDA ë²„ì „ í˜¸í™˜ì„± í™•ì¸

### CPU ì‚¬ìš© ì‹œ
- í•™ìŠµ ì‹œê°„ì´ í¬ê²Œ ì¦ê°€í•  ìˆ˜ ìžˆìŒ
- GNN í•™ìŠµì— ìƒë‹¹í•œ ì‹œê°„ ì†Œìš”

### ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ
- ë°°ì¹˜ í¬ê¸° ì¤„ì´ê¸° (32 â†’ 16)
- ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ 8GB ì´ìƒ ê¶Œìž¥

## ðŸ”§ ë¬¸ì œ í•´ê²°

### ìžì£¼ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜

**1. RDKit ê´€ë ¨ ì˜¤ë¥˜**
```bash
pip uninstall rdkit rdkit-pypi
pip install rdkit-pypi
```

**2. PyTorch Geometric ì„¤ì¹˜ ì˜¤ë¥˜**
```bash
pip install torch-geometric -f https://data.pyg.org/whl/torch-{TORCH_VERSION}+{CUDA_VERSION}.html
```

**3. CUDA ë©”ëª¨ë¦¬ ë¶€ì¡±**
```python
# train.py, inference.pyì—ì„œ ë°°ì¹˜ í¬ê¸° ì¡°ì •
batch_size=16  # ê¸°ë³¸ê°’ 32ì—ì„œ 16ìœ¼ë¡œ ë³€ê²½
```

**4. ëª¨ë¸ íŒŒì¼ ì—†ìŒ ì˜¤ë¥˜**
```bash
# í•™ìŠµì„ ë‹¤ì‹œ ì‹¤í–‰
python train.py
```

## ðŸ“ ëª¨ë¸ ì„¸ë¶€ì‚¬í•­

### ë¶„ìž íŠ¹ì§• (LightGBM ìž…ë ¥)
- ê¸°ë³¸ ë¶„ìž íŠ¹ì„±: MW, LogP, TPSA ë“±
- ì›ìž ê°œìˆ˜: C, N, O, S, F, Cl, Br
- êµ¬ì¡°ì  íŠ¹ì§•: ê³ ë¦¬ ìˆ˜, ë°©í–¥ì¡± ê³ ë¦¬ ë“±
- í™”í•™ íŒ¨í„´: Amide, Phenyl, Trifluoromethyl ë“±

### ê·¸ëž˜í”„ íŠ¹ì§• (GNN ìž…ë ¥)
- ë…¸ë“œ: ì›ìž íŠ¹ì§• (íƒ€ìž…, ì°¨ìˆ˜, í•˜ì´ë¸Œë¦¬ë“œí™” ë“±)
- ì—£ì§€: ê²°í•© íŠ¹ì§• (ë‹¨ì¼/ì´ì¤‘/ì‚¼ì¤‘ê²°í•©, ë°©í–¥ì¡±ì„± ë“±)
- ê¸€ë¡œë²Œ: ë¶„ìž ì „ì²´ íŠ¹ì„±

### ì•™ìƒë¸” ì „ëžµ
- Out-of-Fold ì˜ˆì¸¡ìœ¼ë¡œ ë©”íƒ€ íŠ¹ì§• ìƒì„±
- Ridge íšŒê·€ë¡œ ë‘ ëª¨ë¸ì˜ ì˜ˆì¸¡ ê²°í•©
- ìµœì¢… ì˜ˆì¸¡ê°’ ë²”ìœ„ ì œí•œ ë° í›„ì²˜ë¦¬

## ðŸ“ž ì§€ì›

ë¬¸ì œ ë°œìƒ ì‹œ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:
1. ëª¨ë“  íŒŒì¼ì´ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ìžˆëŠ”ì§€
2. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì´ ìš”êµ¬ì‚¬í•­ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€
3. GPU/CUDA ì„¤ì •ì´ ì˜¬ë°”ë¥¸ì§€
4. ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ì™€ ì €ìž¥ ê³µê°„ì´ ìžˆëŠ”ì§€

---

**ðŸ† Boost up AI 2025 ì‹ ì•½ ê°œë°œ ê²½ì§„ëŒ€íšŒ ì œì¶œìš©**  
**Private Score ë³µì› ê°€ëŠ¥í•œ ì™„ì „ ìž¬í˜„ ëª¨ë¸**